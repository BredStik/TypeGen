version: 1.0.{build}
image: Visual Studio 2022

platform: Any CPU
configuration: Release

init:
  - git config --global core.autocrlf false

before_build:
  - dotnet restore src/TypeGen/TypeGen.Cli
  - dotnet restore src/TypeGen/TypeGen.Core
  - dotnet restore src/TypeGen/TypeGen.Cli.Test
  - dotnet restore src/TypeGen/TypeGen.Core.Test
  - dotnet restore src/TypeGen/TypeGen.IntegrationTest
  - dotnet restore src/TypeGen/TypeGen.TestWebApp

build:
  project: src/TypeGen/TypeGen.sln
  
after_test:
  - ps: ./publish.ps1 -nobuild
  
artifacts:
  - path: '*.nupkg'
    name: NuGet packages
  
deploy:
  provider: NuGet
  api_key:
    secure: Mnc2N3ok1NaB1hGgfsU1uueYm+bTSh2dx9maMq/kZrv8k3jeKGtOcRgUxajGPvdc
  skip_symbols: true